<div>
  <h1 class="titulo-formulario">Nueva Contraseña</h1>
  
  <form [formGroup]="newPasswordForm" (ngSubmit)="onSubmit()">
    <div class="grupo-input">
      <label for="email" class="etiqueta-input">Email</label>
      <input type="text" class="campo-input" formControlName="email" placeholder="Introduce your Email..."   [class.input-error]="newPasswordForm.get('email')?.touched && newPasswordForm.get('email')?.invalid" required>
    
    @if (newPasswordForm.get('newPassword')?.touched && newPasswordForm.get('newPassword')?.invalid) {
    <div class="error-mensaje">
      @if (newPasswordForm.get('email')?.errors?.['required']) {
        <div class="mensaje-error">
          El Email es obligatorio.
        </div>
      }

      @if (newPasswordForm.get('email')?.errors?.['email']) {
        <div class="mensaje-error">
          Formato de Correo Inválido
        </div>
      }
    </div>
    }
    </div>
    <div class="grupo-input">
      <label for="newPassword" class="etiqueta-input">Nueva Contraseña</label>
      <input 
        type="password" 
        id="newPassword"
        maxlength="15"
        class="campo-input" 
        formControlName="newPassword"
        [class.input-error]="newPasswordForm.get('newPassword')?.touched && newPasswordForm.get('newPassword')?.invalid"
        placeholder="Ingresa tu nueva contraseña" 
        required>
      
      @if (newPasswordForm.get('newPassword')?.touched && newPasswordForm.get('newPassword')?.invalid) {
        <div class="error-mensaje">
          @if (newPasswordForm.get('newPassword')?.errors?.['required']) {
            <div class="mensaje-error">
              La nueva contraseña es obligatoria.
            </div>
          }
          @if (newPasswordForm.get('newPassword')?.errors?.['minlength']) {
            <div class="mensaje-error">
              La contraseña debe tener al menos 8 caracteres.
            </div>
          }
          @if (newPasswordForm.get('newPassword')?.errors?.['maxlength']) {
            <div class="mensaje-error">
              La contraseña no puede tener más de 15 caracteres.
            </div>
          }
          @if (newPasswordForm.get('newPassword')?.errors?.['passwordStrength']) {
            <div class="mensaje-error">
              La contraseña debe tener mayúsculas, minúsculas, números y símbolos.
            </div>
          }
          @if (newPasswordForm.get('newPassword')?.errors?.['whitespace']) {
            <div class="mensaje-error">
              La contraseña no puede tener espacios.
            </div>
          }
        </div>
      }
    </div>

    <!-- Mensajes de estado -->
    @if (errorMessage) {
      <div class="mensaje-error">{{ errorMessage }}</div>
    }
    @if (successMessage) {
      <div class="mensaje-exito">{{ successMessage }}</div>
    }
    
    <button 
      type="submit" 
      class="boton-enviar" 
      [disabled]="newPasswordForm.invalid || isLoading">
      {{ isLoading ? 'Actualizando...' : 'Actualizar contraseña' }}
    </button>
  </form>
  <button class="boton-enviar" (click)="returnLogin.emit()">Back</button>
</div>
