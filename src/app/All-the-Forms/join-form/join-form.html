<div>
  <h1 class="titulo-formulario">Bienvenido</h1>

  <form [formGroup]="joinForm" (ngSubmit)="onSubmit()">
    <div class="grupo-input">
      <label for="email" class="etiqueta-input">Correo Electrónico</label>
      <input 
        type="email" 
        id="email" 
        class="campo-input" 
        formControlName="email"
        [class.input-error]="(joinForm.get('email')?.touched && joinForm.get('email')?.invalid) || errorMessage"
        placeholder="usuario@clinica.com" 
        required>
      
      @if (joinForm.get('email')?.touched && joinForm.get('email')?.invalid) {
        <div class="error-mensaje">
          @if (joinForm.get('email')?.errors?.['required']) {
            <div class="mensaje-error">
              El correo electrónico es obligatorio.
            </div>
          }
          @if (joinForm.get('email')?.errors?.['email']) {
            <div class="mensaje-error">
              El formato del correo no es válido.
            </div>
          }
        </div>
      }
    </div>
    
    <div class="grupo-input">
      <label for="password" class="etiqueta-input">Contraseña</label>
      <input 
        type="password" 
        id ="password"
        maxlength="15" 
        id="password" 
        class="campo-input" 
        formControlName="password"
        [class.input-error]="joinForm.get('password')?.touched && joinForm.get('password')?.invalid || errorMessage"
        placeholder="Ingresa tu contraseña" 
        required>
      
      @if (joinForm.get('password')?.touched && joinForm.get('password')?.invalid) {
        <div class="error-mensaje">
          @if (joinForm.get('password')?.errors?.['required']) {
            <div class="mensaje-error">
              La contraseña es obligatoria.
            </div>
          }
          @if (joinForm.get('password')?.errors?.['minlength']) {
            <div class="mensaje-error">
              La contraseña debe tener al menos 8 caracteres.
            </div>
          }
          @if (joinForm.get('password')?.errors?.['maxlength']) {
            <div class="mensaje-error">
              La contraseña no puede tener más de 15 caracteres.
            </div>
          }
          @if (joinForm.get('password')?.errors?.['passwordStrength']) {
            <div class="mensaje-error">
              La contraseña debe tener mayúsculas, minúsculas, números y símbolos.
            </div>
          }
          @if (joinForm.get('password')?.errors?.['whitespace']) {
            <div class="mensaje-error">
              La contraseña no puede tener espacios.
            </div>
          }
        </div>
      }
    </div>

    <div class="grupo-input">
      <label for="repitPassword" class="etiqueta-input">Repetir Contraseña</label>
      <input 
        type="password" 
        id="repitPassword" 
        class="campo-input" 
        formControlName="repitPassword" 
        maxlength="15"
        [class.input-error]="(joinForm.get('repitPassword')?.touched && joinForm.get('repitPassword')?.invalid) || (joinForm.errors?.['fieldsMatch'] && joinForm.get('repitPassword')?.touched)"
        placeholder="Repite tu contraseña" 
        required>
      
      @if (joinForm.get('repitPassword')?.touched && joinForm.get('repitPassword')?.invalid) {
        <div class="error-mensaje">
          @if (joinForm.get('repitPassword')?.errors?.['required']) {
            <div class="mensaje-error">
              La confirmación de contraseña es obligatoria.
            </div>
          }
        </div>
      }
      
      @if (joinForm.errors?.['fieldsMatch'] && joinForm.get('repitPassword')?.touched) {
        <div class="error-mensaje">
          <div class="mensaje-error">
            Las contraseñas no coinciden.
          </div>
        </div>
      }
    </div>
    
    <div class="opciones-formulario">
      <div>
        <input type="checkbox" id="remember" formControlName="rememberMe">
        <label for="remember">Recordar sesión</label>
      </div>
      <div class="enlace-opcion" (click)="switchToPassword.emit()">¿Olvidaste tu contraseña?</div>
    </div>

    <!-- Mensajes de estado -->
    @if (errorMessage) {
      <div class="mensaje-error">{{ errorMessage }}</div>
    }
    @if (successMessage) {
      <div class="mensaje-exito">{{ successMessage }}</div>
    }
    
    <button 
      type="submit" 
      class="boton-enviar" 
      [disabled]="joinForm.invalid || isLoading">
      {{ isLoading ? 'Registrando...' : 'Registrarse' }}
    </button>
    
    <div class="separador">
      <div class="linea-separador"></div>
      <span class="texto-separador">o accede con</span>
      <div class="linea-separador"></div>
    </div>
    
    <div class="contenedor-redes">
      <button type="button" class="boton-red-social">
        <svg class="icono-red-social" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"></svg>
        Google
      </button>
      
      <button type="button" class="boton-red-social">
        <svg class="icono-red-social" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"></svg>
        Facebook
      </button>
    </div>
  </form>
  
  <div class="pie-formulario" (click)="switchToLogin.emit()">
    ¿Ya tienes una cuenta? <span class="enlace-registro">Login</span>
  </div>
</div>
